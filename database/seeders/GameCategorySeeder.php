<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\GameCategory;
use App\Models\SlotegratorGame;

class GameCategorySeeder extends Seeder
{
    public function run(): void
    {
        // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð¾Ð²
        $categories = [
            [
                'name' => 'Ð¡Ð»Ð¾Ñ‚Ñ‹',
                'slug' => 'slots',
                'description' => 'ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð¸Ð³Ñ€Ð¾Ð²Ñ‹Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ñ‹',
                'icon' => '<svg fill="currentColor" viewBox="0 0 96 96" class="h-5 w-5"><path fill-rule="evenodd" d="M56.8 47.08a49.76 49.76 0 0 0-5.6 22.8v5H32.32a55.6 55.6 0 0 1 5-22.76A87 87 0 0 1 50.8 31h-28V16.36H72v7.76a134 134 0 0 0-15.2 22.96m26.4 16.24a30.56 30.56 0 0 0-6 13.04l-.6 3L60 76.32a38.12 38.12 0 0 1 13.36-22.28l-12-2.36 5.04-10.64L96 46.88l-.92 4.64a85.5 85.5 0 0 0-11.88 11.8m-58.52 9.32a30.1 30.1 0 0 1 0-14.36 79.7 79.7 0 0 1 5.8-15.84l-1.12-4.6L0 44.88v11.68l12-2.84a37.88 37.88 0 0 0-2.88 25.92l16.28-4z" clip-rule="evenodd"></path></svg>',
                'color' => '#ffb300',
                'order' => 1,
                'is_active' => true,
                'show_on_homepage' => true,
            ],
            [
                'name' => 'Live',
                'slug' => 'live',
                'description' => 'Ð˜Ð³Ñ€Ñ‹ Ñ Ð¶Ð¸Ð²Ñ‹Ð¼Ð¸ Ð´Ð¸Ð»ÐµÑ€Ð°Ð¼Ð¸',
                'icon' => '<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>',
                'color' => '#ef4444',
                'order' => 2,
                'is_active' => true,
                'show_on_homepage' => true,
            ],
            [
                'name' => 'Ð ÑƒÐ»ÐµÑ‚ÐºÐ¸',
                'slug' => 'roulette',
                'description' => 'ÐšÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¸ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ñ€ÑƒÐ»ÐµÑ‚ÐºÐ¸',
                'icon' => '<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3c-4.96252 0-9 4.03748-9 9 0 4.9625 4.03748 9 9 9 4.9625 0 9-4.0375 9-9 0-4.96252-4.0375-9-9-9zm.375 1.51904c.6346.03163 1.2502.13312 1.834.31348l-.5142 1.41504c-.4223-.12465-.8646-.20018-1.3198-.22852zm-3.28857.56983.51416 1.41504c-.41277.18095-.79903.41034-1.15723.67529l-.96387-1.1499c.4932-.37436 1.02947-.69599 1.60694-.94043zm8.00827 1.42236c.4553.42293.8589.89896 1.1983 1.42236l-1.2979.74854c-.2487-.3734-.5405-.71416-.8642-1.02246zm-5.0947.98877c2.4814 0 4.5 2.01855 4.5 4.5 0 2.4814-2.0186 4.5-4.5 4.5-2.48145 0-4.5-2.0186-4.5-4.5 0-2.48145 2.01855-4.5 4.5-4.5zm0 .75c-.4135 0-.75.33655-.75.75 0 .27393.155.50336.375.63428v.91842c-.5246.1364-.9359.5477-1.0723 1.0723h-.91842c-.13092-.22-.36035-.375-.63428-.375-.41345 0-.75.3365-.75.75s.33655.75.75.75c.27393 0 .50336-.155.63428-.375h.91842c.1364.5246.5477.9359 1.0723 1.0723v.9184c-.22.1309-.375.3604-.375.6343 0 .4135.3365.75.75.75s.75-.3365.75-.75c0-.2739-.155-.5034-.375-.6343v-.9184c.5246-.1364.9359-.5477 1.0723-1.0723h.9184c.1309.22.3604.375.6343.375.4135 0 .75-.3365.75-.75s-.3365-.75-.75-.75c-.2739 0-.5034.155-.6343.375h-.9184c-.1364-.5246-.5477-.9359-1.0723-1.0723v-.91842c.22-.13092.375-.36035.375-.63428 0-.41345-.3365-.75-.75-.75zm-6.66797.33252 1.30078.75146c-.19784.3967-.35202.81802-.45849 1.25832l-1.48096-.2608c.14044-.61492.35696-1.2015.63867-1.74898zm14.10347 2.48728c.0381.3056.0645.6145.0645.9302s-.0264.6246-.0645.9302l-1.4751-.2593c.0247-.2204.0396-.444.0396-.6709s-.0149-.4505-.0396-.6709zm-13.26118 2.3379c.10647.4403.26065.8616.45849 1.2583l-1.30078.7515c-.28171-.5475-.49823-1.1341-.63867-1.749zm10.82078 1.9102 1.2979.7485c-.3394.5234-.743.9994-1.1983 1.4224l-.9638-1.1485c.3237-.3083.6155-.649.8642-1.0224zm-8.55174 1.5029c.3582.265.74446.4943 1.15723.6753l-.51416 1.415c-.57747-.2444-1.11374-.566-1.60694-.9404zm5.25144.9316.5142 1.4151c-.5838.1803-1.1994.2818-1.834.3135v-1.5c.4552-.0284.8975-.1039 1.3198-.2286z"/></svg>',
                'color' => '#8b5cf6',
                'order' => 3,
                'is_active' => true,
                'show_on_homepage' => true,
            ],
            [
                'name' => 'Blackjack',
                'slug' => 'blackjack',
                'description' => 'ÐÐ°ÑÑ‚Ð¾Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð³Ñ€Ñ‹ Ð¸ Ð±Ð»ÑÐºÐ´Ð¶ÐµÐº',
                'icon' => '<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.24 5.634a.92.92 0 0 1 .817.5l.21.434-2.846 8.556-.031.133a.925.925 0 0 0 .61 1.02l7.779 2.61h.119l-.002.004a.87.87 0 0 1-.347.328l-7.342 3.686a.92.92 0 0 1-1.226-.412L1.084 10.615l.002.006a.926.926 0 0 1 .402-1.205l7.348-3.688-.006.002a.9.9 0 0 1 .41-.097z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.312 1c.1 0 .198.016.282.044l7.778 2.591.008.002a.923.923 0 0 1 .572 1.17l-4.189 12.586-.002.006a.92.92 0 0 1-1.145.565l-7.78-2.609-.006-.002a.92.92 0 0 1-.573-1.15l4.189-12.586.002-.007a.92.92 0 0 1 .864-.61zm3.341 6.719a.23.23 0 0 0-.073.092l-.157.435v.003c0 .062.043.113.101.126l.643.24-1.111 3.126a.1.1 0 0 0-.012.05c0 .059.04.108.093.124l.772.277a.1.1 0 0 0 .043.008.13.13 0 0 0 .123-.09l1.589-4.419a.14.14 0 0 0-.082-.175l-.634-.23zM15.25 5.948a2.1 2.1 0 0 0-1.033.268.14.14 0 0 0-.054.185l.248.646a.15.15 0 0 0 .193.072l-.004.003a1.04 1.04 0 0 1 .803-.113h.004a.58.58 0 0 1 .428.719l-.003.007a1.1 1.1 0 0 1-.364.454c-.643.434-2.158 1.466-2.755 1.844v.147a.14.14 0 0 0 .082.176l2.755.996h-.002a.1.1 0 0 0 .038.005c.063 0 .117-.04.138-.097l.22-.617a.15.15 0 0 0-.083-.184l-1.212-.434c.487-.34 1.314-.886 1.681-1.199l.004-.003a1.9 1.9 0 0 0 .583-.808h.001a1.516 1.516 0 0 0-1.075-1.983l.015.004a2.1 2.1 0 0 0-.608-.088"/></svg>',
                'color' => '#10b981',
                'order' => 4,
                'is_active' => true,
                'show_on_homepage' => true,
            ],
        ];

        foreach ($categories as $categoryData) {
            $category = GameCategory::create($categoryData);

            // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¸Ð³Ñ€Ñ‹ Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ñ„Ð»Ð°Ð³Ð¾Ð²
            switch ($category->slug) {
                case 'slots':
                    $games = SlotegratorGame::where('is_popular', true)
                        ->where('is_active', true)
                        ->orderBy('updated_at', 'desc')
                        ->take(30)
                        ->get();
                    break;

                case 'live':
                    $games = SlotegratorGame::where('is_live', true)
                        ->where('is_active', true)
                        ->inRandomOrder()
                        ->take(30)
                        ->get();
                    break;

                case 'roulette':
                    $games = SlotegratorGame::where('is_roulette', true)
                        ->where('is_active', true)
                        ->inRandomOrder()
                        ->take(30)
                        ->get();
                    break;

                case 'blackjack':
                    $games = SlotegratorGame::where('is_table', true)
                        ->where('is_active', true)
                        ->inRandomOrder()
                        ->take(30)
                        ->get();
                    break;

                default:
                    $games = collect();
            }

            // ÐŸÑ€Ð¸Ð²ÑÐ·Ñ‹Ð²Ð°ÐµÐ¼ Ð¸Ð³Ñ€Ñ‹ Ðº ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
            if ($games->isNotEmpty()) {
                $syncData = [];
                foreach ($games as $index => $game) {
                    $syncData[$game->id] = ['order' => $index + 1];
                }
                $category->games()->sync($syncData);
            }
        }

        $this->command->info('âœ… ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹!');
        $this->command->info('ðŸ“Š Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹: ' . count($categories));
    }
}
